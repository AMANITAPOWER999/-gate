# Overview

This is a cryptocurrency trading bot application that implements an automated trading strategy with a market simulator. The system uses SAR (Parabolic SAR) indicators across multiple timeframes (1m, 3m, 15m) to generate trading signals for ETH/USDT. The application features a Flask-based web dashboard for monitoring and controlling the bot, along with Telegram notifications for trade alerts.

# Recent Changes

## September 13, 2025 - Случайное время сделок 6-12 минут
- **Логика времени сделок**: Изменена с фиксированных 15 минут на случайное время от 6 до 12 минут для каждой позиции
- **Реализация**: Генерируется случайное значение от 360 до 720 секунд при открытии каждой позиции
- **Приоритет закрытия**: 1) Случайное время → 2) Тейк профит 150% → 3) Смена 1m SAR
- **Логирование**: Добавлено отображение выбранного времени закрытия при открытии позиции

## September 12, 2025 - Упрощенная SAR стратегия и исправления  
- **Новая стратегия**: Открытие позиций только при совпадении 15m и 1m SAR (убрали 5m)
- **Закрытие**: По смене 1m SAR направления (без изменений)
- **Исправлено дублирование**: Убрано повторное уведомление о балансе в Telegram
- **Дашборд**: Обновление каждые 3 секунды для мониторинга в реальном времени
- **Критическая ошибка**: Исправлен баг с зависанием торгового цикла, приводивший к большим убыткам
- **Бумажная торговля**: Сброс баланса на $1000 с очисткой истории сделок

# User Preferences

Preferred communication style: Simple, everyday language.

# System Architecture

## Frontend Architecture
- **Framework**: Vanilla JavaScript with Bootstrap 5 and Chart.js
- **Design Pattern**: Single Page Application (SPA) with real-time updates
- **UI Components**: Dark theme trading dashboard with responsive cards, status indicators, and interactive charts
- **Data Updates**: Polling-based architecture that fetches data from Flask API endpoints every few seconds

## Backend Architecture
- **Framework**: Flask with Python
- **Design Pattern**: Modular architecture with separate components for trading logic, notifications, and web interface
- **Core Components**:
  - `TradingBot` class: Handles exchange integration/simulation, SAR calculations, and position management
  - `MarketSimulator` class: Generates realistic market data for demonstration
  - `TelegramNotifier` class: Manages notification delivery
  - Flask app: Provides REST API endpoints and serves the dashboard
- **Threading Model**: Main Flask thread + background trading thread for continuous market monitoring

## Trading Strategy
- **Algorithm**: Simplified SAR (Parabolic SAR) strategy using 15m and 1m timeframes
- **Entry Condition**: Open position when 15m SAR = 1m SAR direction
- **Exit Condition**: Close position when 1m SAR changes direction
- **Risk Management**: Fixed 10% position sizing, 2-minute minimum trade duration, 1-minute pause between trades
- **Operating Modes**: Paper trading mode with $1000 starting balance
- **Position Management**: Long/short positions with x500 leverage, automatic entry/exit based on SAR signal alignment
- **Trade Duration**: Random position close time between 6-12 minutes (360-720 seconds) generated for each trade

## Data Storage
- **State Persistence**: JSON file-based storage for bot state, trading history, and configuration
- **In-Memory Storage**: Global state dictionary for real-time data sharing between components
- **No Database**: Simple file-based approach for lightweight deployment

## Authentication & Security
- **API Security**: Environment variable-based API key management for OKX exchange
- **Session Management**: Flask secret key for basic session security
- **No User Authentication**: Single-user application without login system

# External Dependencies

## Trading Exchange
- **OKX API**: Cryptocurrency exchange integration via ccxt library
- **Authentication**: API key, secret, and passphrase stored in environment variables
- **Market Data**: Real-time price feeds and order book data
- **Order Execution**: Futures contract trading with leverage support

## Notification Services
- **Telegram Bot API**: Real-time trade notifications and alerts
- **Configuration**: Bot token and chat ID via environment variables
- **Message Format**: HTML-formatted messages with trade details and emojis

## Technical Analysis
- **TA Library**: Python technical analysis library for SAR indicator calculations
- **Pandas**: Data manipulation for OHLCV processing
- **Multiple Timeframes**: 1-minute, 3-minute, and 15-minute chart analysis
- **Market Simulation**: Custom simulator for generating realistic price movements

## Frontend Libraries
- **Bootstrap 5**: CSS framework for responsive UI design
- **Chart.js**: Real-time price charting and visualization
- **Font Awesome**: Icon library for UI elements
- **No Authentication Library**: Simple session-based approach

## Python Libraries
- **ccxt**: Unified cryptocurrency exchange API
- **Flask**: Web framework for dashboard and API
- **Requests**: HTTP client for Telegram API calls
- **Threading**: Built-in Python threading for background processes